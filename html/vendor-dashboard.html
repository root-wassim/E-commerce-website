<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seller Dashboard - NeoMarket</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <!-- Updated CSS paths -->
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/variables.css">
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/components.css">
  <link rel="stylesheet" href="../css/layout.css">
  <link rel="stylesheet" href="../css/responsive.css">
  <style>
    .vendor-layout {
      display: grid;
      grid-template-columns: 260px 1fr;
      min-height: 100vh;
    }

    .vendor-sidebar {
      background: var(--surface);
      border-right: 1px solid var(--glass-border);
      padding: var(--space-xl);
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .vendor-logo {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-family: var(--font-heading);
      font-size: 1.5rem;
      font-weight: 900;
      color: var(--accent);
      margin-bottom: var(--space-2xl);
      padding-bottom: var(--space-xl);
      border-bottom: 1px solid var(--glass-border);
    }

    .vendor-nav {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .vendor-nav-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      color: var(--muted);
      border-radius: var(--radius-sm);
      transition: all var(--transition-fast);
      cursor: pointer;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .vendor-nav-item:hover {
      background: rgba(0, 230, 195, 0.1);
      color: var(--accent);
    }

    .vendor-nav-item.active {
      background: rgba(0, 230, 195, 0.1);
      color: var(--accent);
      border-left: 3px solid var(--accent);
    }

    .vendor-main {
      padding: var(--space-2xl);
    }

    .vendor-header {
      margin-bottom: var(--space-2xl);
      padding-bottom: var(--space-xl);
      border-bottom: 1px solid var(--glass-border);
    }

    .vendor-section {
      display: none;
    }

    .vendor-section.active {
      display: block;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: var(--space-xl);
      margin-bottom: var(--space-3xl);
    }

    .stat-card {
      background: var(--surface);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      padding: var(--space-xl);
      backdrop-filter: blur(10px);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: rgba(0, 230, 195, 0.2);
      color: var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      margin-bottom: var(--space-md);
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--muted);
      margin-bottom: var(--space-sm);
    }

    .stat-value {
      font-size: 2rem;
      font-family: var(--font-heading);
      color: var(--text);
      font-weight: 700;
    }

    .data-table {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .data-table thead {
      background: rgba(0, 0, 0, 0.3);
    }

    .data-table th {
      padding: var(--space-lg);
      text-align: left;
      font-weight: 700;
      color: var(--text);
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid var(--glass-border);
    }

    .data-table td {
      padding: var(--space-lg);
      border-bottom: 1px solid var(--glass-border);
      color: var(--muted);
    }

    .data-table tr:last-child td {
      border-bottom: none;
    }

    .data-table tbody tr {
      transition: background var(--transition-fast);
    }

    .data-table tbody tr:hover {
      background: rgba(0, 230, 195, 0.05);
    }

    .product-thumb {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      object-fit: cover;
      background: rgba(0, 0, 0, 0.3);
    }

    .action-buttons {
      display: flex;
      gap: var(--space-sm);
    }

    .btn-icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: var(--surface);
      border: 1px solid var(--glass-border);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .btn-icon:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    @media (max-width: 1024px) {
      .vendor-layout {
        grid-template-columns: 1fr;
      }

      .vendor-sidebar {
        position: static;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--glass-border);
      }
    }
  </style>
</head>
<body>
  <div class="vendor-layout">
    <!-- Sidebar -->
    <aside class="vendor-sidebar">
      <a href="index.html" class="vendor-logo">
        <span>‚óÜ</span>
        <span>NeoMarket</span>
      </a>
      <nav class="vendor-nav">
        <div class="vendor-nav-item active" onclick="showVendorSection('dashboard')">
          <span>üìä</span>
          <span>Dashboard</span>
        </div>
        <div class="vendor-nav-item" onclick="showVendorSection('listings')">
          <span>üì¶</span>
          <span>My Listings</span>
        </div>
        <div class="vendor-nav-item" onclick="showVendorSection('sales')">
          <span>üí∞</span>
          <span>Sales</span>
        </div>
        <div class="vendor-nav-item" onclick="showVendorSection('performance')">
          <span>üìà</span>
          <span>Performance</span>
        </div>
        <div style="margin-top: auto; padding-top: var(--space-2xl); border-top: 1px solid var(--glass-border);">
          <a href="index.html" class="vendor-nav-item">
            <span>üè†</span>
            <span>Back to Store</span>
          </a>
          <div class="vendor-nav-item" onclick="logout()">
            <span>üö™</span>
            <span>Logout</span>
          </div>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="vendor-main">
      <!-- Dashboard Section -->
      <section class="vendor-section active" id="vendor-section-dashboard">
        <div class="vendor-header">
          <h1>Seller Dashboard</h1>
          <p style="color: var(--muted);">Welcome back! Here's your overview.</p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üì¶</div>
            <div class="stat-label">Active Listings</div>
            <div class="stat-value" id="vendor-stat-listings">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üí∞</div>
            <div class="stat-label">Total Revenue</div>
            <div class="stat-value" id="vendor-stat-revenue">$0</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">‚≠ê</div>
            <div class="stat-label">Average Rating</div>
            <div class="stat-value" id="vendor-stat-rating">4.8</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üöÄ</div>
            <div class="stat-label">Orders This Month</div>
            <div class="stat-value" id="vendor-stat-orders">0</div>
          </div>
        </div>

        <div style="background: rgba(0, 230, 195, 0.1); border: 1px solid var(--accent); border-radius: var(--radius-md); padding: var(--space-xl); margin-bottom: var(--space-2xl);">
          <h3 style="color: var(--accent); margin-bottom: var(--space-md);">Getting Started</h3>
          <p style="color: var(--muted); margin-bottom: var(--space-lg);">Ready to start selling? List your first product and reach thousands of gamers!</p>
          <button class="btn btn-primary" onclick="showVendorSection('listings')">View My Listings</button>
        </div>

        <div style="background: var(--surface); border: 1px solid var(--glass-border); border-radius: var(--radius-md); padding: var(--space-xl); backdrop-filter: blur(10px);">
          <h3 style="margin-bottom: var(--space-lg);">Recent Activity</h3>
          <p style="color: var(--muted);">No recent activity. Start by adding your first product listing!</p>
        </div>
      </section>

      <!-- Listings Section -->
      <section class="vendor-section" id="vendor-section-listings">
        <div class="vendor-header">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <h1>My Listings</h1>
              <p style="color: var(--muted);">Manage your product listings</p>
            </div>
            <button class="btn btn-primary" onclick="window.location.href='admin.html'">
              Add New Listing
            </button>
          </div>
        </div>

        <div style="overflow-x: auto;">
          <table class="data-table">
            <thead>
              <tr>
                <th>Product</th>
                <th>Category</th>
                <th>Price</th>
                <th>Stock</th>
                <th>Views</th>
                <th>Sales</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="vendorListingsBody">
              <!-- Listings will be dynamically inserted -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Sales Section -->
      <section class="vendor-section" id="vendor-section-sales">
        <div class="vendor-header">
          <h1>Sales Overview</h1>
          <p style="color: var(--muted);">Track your sales and revenue</p>
        </div>

        <div class="stats-grid" style="margin-bottom: var(--space-2xl);">
          <div class="stat-card">
            <div class="stat-label">Today's Sales</div>
            <div class="stat-value" style="color: var(--accent);">$0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">This Week</div>
            <div class="stat-value" style="color: var(--accent);">$0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">This Month</div>
            <div class="stat-value" style="color: var(--accent);">$0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">All Time</div>
            <div class="stat-value" style="color: var(--accent);">$0</div>
          </div>
        </div>

        <div style="background: var(--surface); border: 1px solid var(--glass-border); border-radius: var(--radius-md); padding: var(--space-xl); backdrop-filter: blur(10px); text-align: center;">
          <p style="color: var(--muted); font-size: 1.125rem;">No sales data available yet</p>
          <p style="color: var(--muted); margin-top: var(--space-md);">Sales analytics will appear here once you start making sales</p>
        </div>
      </section>

      <!-- Performance Section -->
      <section class="vendor-section" id="vendor-section-performance">
        <div class="vendor-header">
          <h1>Performance Metrics</h1>
          <p style="color: var(--muted);">Monitor your seller performance</p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Response Time</div>
            <div class="stat-value" style="font-size: 1.5rem;">2h</div>
            <p style="color: var(--success); font-size: 0.875rem; margin-top: var(--space-sm);">Excellent</p>
          </div>
          <div class="stat-card">
            <div class="stat-label">Shipping Speed</div>
            <div class="stat-value" style="font-size: 1.5rem;">1.5d</div>
            <p style="color: var(--success); font-size: 0.875rem; margin-top: var(--space-sm);">Fast</p>
          </div>
          <div class="stat-card">
            <div class="stat-label">Customer Satisfaction</div>
            <div class="stat-value" style="font-size: 1.5rem;">98%</div>
            <p style="color: var(--success); font-size: 0.875rem; margin-top: var(--space-sm);">Outstanding</p>
          </div>
          <div class="stat-card">
            <div class="stat-label">Return Rate</div>
            <div class="stat-value" style="font-size: 1.5rem;">1.2%</div>
            <p style="color: var(--success); font-size: 0.875rem; margin-top: var(--space-sm);">Low</p>
          </div>
        </div>

        <div style="background: var(--surface); border: 1px solid var(--glass-border); border-radius: var(--radius-md); padding: var(--space-xl); backdrop-filter: blur(10px); margin-top: var(--space-2xl);">
          <h3 style="margin-bottom: var(--space-lg);">Seller Tips</h3>
          <ul style="color: var(--muted); line-height: 1.8; padding-left: var(--space-lg);">
            <li>Respond to customer inquiries within 24 hours</li>
            <li>Ship products within 2 business days</li>
            <li>Provide accurate product descriptions and photos</li>
            <li>Maintain competitive pricing</li>
            <li>Collect and respond to customer reviews</li>
          </ul>
        </div>
      </section>
    </main>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Updated JS paths -->
  <script src="../js/config.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/toasts.js"></script>
  <script src="../js/modals.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/cart.js"></script>
  <script src="../js/wishlist.js"></script>
  <script src="../js/products.js"></script>
  <script src="../js/main.js"></script>
  <script>
    // Check if user is logged in and is a seller or admin
    const currentUser = getCurrentUser();
    if (!currentUser) {
      window.location.href = 'login.html?redirect=' + encodeURIComponent(window.location.pathname);
    } else if (currentUser.role !== 'seller' && currentUser.role !== 'admin') {
      showToast('Seller account required', 'error');
      setTimeout(() => window.location.href = 'index.html', 2000);
    }

    function showVendorSection(sectionName) {
      // Update nav items
      document.querySelectorAll('.vendor-nav-item').forEach(item => {
        item.classList.remove('active');
      });
      event.currentTarget.classList.add('active');

      // Update sections
      document.querySelectorAll('.vendor-section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(`vendor-section-${sectionName}`).classList.add('active');

      // Load section data
      if (sectionName === 'listings') {
        loadVendorListings();
      }
    }

    function loadVendorDashboard() {
      const products = getProducts();
      const userProducts = products.filter(p => p.vendorId === currentUser.id || currentUser.role === 'admin');
      
      document.getElementById('vendor-stat-listings').textContent = userProducts.length;
      
      // Mock revenue calculation
      const revenue = userProducts.reduce((sum, p) => sum + (p.price * Math.floor(Math.random() * 5)), 0);
      document.getElementById('vendor-stat-revenue').textContent = formatCurrency(revenue);
    }

    function loadVendorListings() {
      const products = getProducts();
      const tbody = document.getElementById('vendorListingsBody');

      // In a real app, filter by vendor ID
      // For demo, show all products
      const userProducts = products.slice(0, 5);

      if (userProducts.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: var(--space-3xl); color: var(--muted);">
              <p style="font-size: 1.125rem; margin-bottom: var(--space-md);">No listings yet</p>
              <button class="btn btn-primary" onclick="window.location.href='admin.html'">Add Your First Product</button>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = userProducts.map(product => `
        <tr>
          <td>
            <div style="display: flex; align-items: center; gap: var(--space-md);">
              <img src="${product.primaryImage}" alt="${escapeHtml(product.title)}" class="product-thumb">
              <div>
                <div style="color: var(--text); font-weight: 600;">${escapeHtml(truncate(product.title, 40))}</div>
                <div style="font-size: 0.75rem; color: var(--muted);">${product.modelNumber}</div>
              </div>
            </div>
          </td>
          <td>${product.category.toUpperCase()}</td>
          <td style="color: var(--accent); font-weight: 700;">${formatCurrency(product.price)}</td>
          <td>${product.stock}</td>
          <td>${Math.floor(Math.random() * 1000)}</td>
          <td>${Math.floor(Math.random() * 50)}</td>
          <td>
            <div class="action-buttons">
              <button class="btn-icon" onclick="window.location.href='product-detail.html?id=${product.id}'" title="View">üëÅ</button>
              <button class="btn-icon" title="Edit">‚úé</button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadVendorDashboard();
      loadVendorListings();
    });
  </script>
</body>
</html>
